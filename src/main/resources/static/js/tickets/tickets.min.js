var ShoppingBasket;(function(a){ShoppingBasket={LOCAL_STORAGE_SHOPPING_BASKET:"shoppingBasket",shoppingBasket:[],init:function(){if(Storages.localStorage.get(ShoppingBasket.LOCAL_STORAGE_SHOPPING_BASKET)!==null){ShoppingBasket.shoppingBasket=Storages.localStorage.get(ShoppingBasket.LOCAL_STORAGE_SHOPPING_BASKET)}ShoppingBasket.__createShoppingBasketTable();ShoppingBasket.binds()},binds:function(){a("#emptyShoppingBasket").on("click",ShoppingBasket.__emptyShoppingBasket);a("#orderForm").on("submit",ShoppingBasket.__beforeShoppingBasketSubmit);a(".btn-shopping-basket").on("click",ShoppingBasket.__addProductToShoppingBasket)},__beforeShoppingBasketSubmit:function(){const c='<input type="hidden" name="products[%s]" value="%s">';var b=0;a.each(ShoppingBasket.shoppingBasket,function(d,e){a("#products").append(vsprintf(c,[e.key,e.amount]));b++})},__emptyShoppingBasket:function(){ShoppingBasket.shoppingBasket=[];Storages.localStorage.set(ShoppingBasket.LOCAL_STORAGE_SHOPPING_BASKET,[]);ShoppingBasket.__createShoppingBasketTable()},__addProductToShoppingBasket:function(c){c.preventDefault();var b=ShoppingBasket.__indexProductContains(a(c.target).data("product-key"),ShoppingBasket.shoppingBasket);if(b>=0){if(ShoppingBasket.shoppingBasket[b].amount<a(c.target).data("customer-limit")){ShoppingBasket.shoppingBasket[b].amount++}else{ShoppingBasket.__shakeShoppingBasket();return false}}else{ShoppingBasket.shoppingBasket.push({key:a(c.target).data("product-key"),title:a(c.target).data("product-title"),cost:a(c.target).data("product-cost"),amount:1})}ShoppingBasket.__pulseShoppingBasket();Storages.localStorage.set(ShoppingBasket.LOCAL_STORAGE_SHOPPING_BASKET,ShoppingBasket.shoppingBasket);ShoppingBasket.__createShoppingBasketTable()},__createShoppingBasketTable:function(){if(ShoppingBasket.shoppingBasket.length===0){ShoppingBasket.__createEmptyShoppingBasketTable()}else{var d="";var c=0;var b=0;a.each(ShoppingBasket.shoppingBasket,function(e,f){d+=vsprintf("<tr><td>%s</td><td>%s</td><td>&euro; %s</td></tr>",[f.title,f.amount,parseFloat(Math.round(f.amount*f.cost*100)/100).toFixed(2).replace(".",",")]);b+=f.amount;c+=f.amount*f.cost});if(c>0){d+="<tr><td>Transaction fee</td><td>1</td><td>&euro; 0,35</td></tr>";c+=0.35}a("#shoppingBasketTable").html(d);a("#shoppingBasketCount").html(b);a("#shoppingBasketTotal").html("&euro; "+parseFloat(Math.round(c*100)/100).toFixed(2).replace(".",","))}},__createEmptyShoppingBasketTable:function(){a("#shoppingBasketCount").html(0);a("#shoppingBasketTable").html("<tr><td colspan='3'>Shopping basket is empty!</td></tr>");a("#shoppingBasketTotal").html("")},__indexProductContains:function(c,d){for(var b=0;b<d.length;b++){if(d[b].key===c){return b}}return -1},__pulseShoppingBasket:function(){var b=a("#shoppingBasketButton");b.addClass("animated pulse").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){a(this).removeClass("animated pulse")})},__shakeShoppingBasket:function(){var b=a("#shoppingBasketButton");b.addClass("animated shake").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){a(this).removeClass("animated shake")})}}})(jQuery);