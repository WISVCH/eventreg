var ShoppingBasket;(function(a){ShoppingBasket={LOCAL_STORAGE_SHOPPING_BASKET:"shoppingBasket",toast_id:0,shoppingBasket:[],init:function(){if(Storages.localStorage.get(ShoppingBasket.LOCAL_STORAGE_SHOPPING_BASKET)!==null){ShoppingBasket.shoppingBasket=Storages.localStorage.get(ShoppingBasket.LOCAL_STORAGE_SHOPPING_BASKET)}ShoppingBasket.__createShoppingBasketTable();ShoppingBasket.binds()},binds:function(){a("#emptyShoppingBasket").on("click",ShoppingBasket.__emptyShoppingBasket);a("#orderForm").on("submit",ShoppingBasket.__beforeShoppingBasketSubmit);a(".btn-shopping-basket").on("click",ShoppingBasket.__addProductToShoppingBasket)},__beforeShoppingBasketSubmit:function(){const c='<input type="hidden" name="products[%s]" value="%s">';var b=0;a.each(ShoppingBasket.shoppingBasket,function(d,e){a("#products").append(vsprintf(c,[e.key,e.amount]));b++})},__emptyShoppingBasket:function(){ShoppingBasket.shoppingBasket=[];Storages.localStorage.set(ShoppingBasket.LOCAL_STORAGE_SHOPPING_BASKET,[]);ShoppingBasket.__createShoppingBasketTable()},__addProductToShoppingBasket:function(c){c.preventDefault();var b=ShoppingBasket.__indexProductContains(a(c.target).data("product-key"),ShoppingBasket.shoppingBasket);if(b>=0){if(ShoppingBasket.shoppingBasket[b].amount<a(c.target).data("customer-limit")){ShoppingBasket.shoppingBasket[b].amount++}else{ShoppingBasket.__shakeShoppingBasket();return false}}else{ShoppingBasket.shoppingBasket.push({key:a(c.target).data("product-key"),title:a(c.target).data("product-title"),cost:a(c.target).data("product-cost"),amount:1})}ShoppingBasket.__pulseShoppingBasket();Storages.localStorage.set(ShoppingBasket.LOCAL_STORAGE_SHOPPING_BASKET,ShoppingBasket.shoppingBasket);ShoppingBasket.__createShoppingBasketTable()},__createShoppingBasketTable:function(){if(ShoppingBasket.shoppingBasket.length===0){ShoppingBasket.__createEmptyShoppingBasketTable()}else{var d="";var c=0;var b=0;a.each(ShoppingBasket.shoppingBasket,function(e,g){var f="<tr><td>%s</td><td><a href='#' class='decreaseBasketAmount' data-product-key='%s'><i class='fas fa-minus'></i></a><span class='px-4'>%s</span><a href='#' class='increaseBasketAmount' data-product-key='%s'><i class='fas fa-plus'></i></a></td><td>&euro; %s</td></tr>";d+=vsprintf(f,[g.title,g.key,g.amount,g.key,parseFloat(Math.round(g.amount*g.cost*100)/100).toFixed(2).replace(".",",")]);b+=g.amount;c+=g.amount*g.cost});if(c>0){d+="<tr><td>Transaction fee</td><td></td><td>&euro; 0,35</td></tr>";c+=0.35}a("#shoppingBasketTable").html(d);a("#shoppingBasketCount").html(b);a("#shoppingBasketTotal").html("&euro; "+parseFloat(Math.round(c*100)/100).toFixed(2).replace(".",","));a(".increaseBasketAmount").on("click",ShoppingBasket.__increaseProductAmount);a(".decreaseBasketAmount").on("click",ShoppingBasket.__decreaseProductAmount)}},__increaseProductAmount:function(c){c.preventDefault();var b=ShoppingBasket.__indexProductContains(a(c.currentTarget).data("productKey"),ShoppingBasket.shoppingBasket);ShoppingBasket.shoppingBasket[b].amount++;Storages.localStorage.set(ShoppingBasket.LOCAL_STORAGE_SHOPPING_BASKET,ShoppingBasket.shoppingBasket);ShoppingBasket.__createShoppingBasketTable()},__decreaseProductAmount:function(c){c.preventDefault();var b=ShoppingBasket.__indexProductContains(a(c.currentTarget).data("productKey"),ShoppingBasket.shoppingBasket);if(ShoppingBasket.shoppingBasket[b].amount>1){ShoppingBasket.shoppingBasket[b].amount--}else{ShoppingBasket.shoppingBasket.splice(b,1)}Storages.localStorage.set(ShoppingBasket.LOCAL_STORAGE_SHOPPING_BASKET,ShoppingBasket.shoppingBasket);ShoppingBasket.__createShoppingBasketTable()},__createEmptyShoppingBasketTable:function(){a("#shoppingBasketCount").html(0);a("#shoppingBasketTable").html("<tr><td colspan='3'>Shopping basket is empty!</td></tr>");a("#shoppingBasketTotal").html("")},__indexProductContains:function(c,d){for(var b=0;b<d.length;b++){if(d[b].key===c){return b}}return -1},__pulseShoppingBasket:function(){var b=a("#shoppingBasketButton");b.addClass("animated pulse").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){a(this).removeClass("animated pulse")});ShoppingBasket.__toast("Product added to your shopping basket.")},__shakeShoppingBasket:function(){var b=a("#shoppingBasketButton");b.addClass("animated shake").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){a(this).removeClass("animated shake")});ShoppingBasket.__toast("You reached the maximum sold per customer.")},__toast:function(c){var b=document.createElement("div");b.className="toast show";b.innerHTML=c;document.body.appendChild(b);setTimeout(function(){b.className=b.className.replace("show","")},3000)}}})(jQuery);